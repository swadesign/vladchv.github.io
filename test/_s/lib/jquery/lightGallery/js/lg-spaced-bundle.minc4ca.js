(function(o,l,t){"use strict";function s(e,l){if(this.el=e,this.$el=o(e),this.s=o.extend({},a,l),this.s.dynamic&&"undefined"!==this.s.dynamicEl&&this.s.dynamicEl.constructor===Array&&!this.s.dynamicEl.length)throw"When using dynamic mode, you must also define dynamicEl as an Array.";return this.modules={},this.lGalleryOn=!1,this.lgBusy=!1,this.hideBartimeout=!1,this.isTouch="ontouchstart"in t.documentElement,this.s.slideEndAnimatoin&&(this.s.hideControlOnEnd=!1),this.$items=this.s.dynamic?this.s.dynamicEl:"this"===this.s.selector?this.$el:""===this.s.selector?this.$el.children():this.s.selectWithin?o(this.s.selectWithin).find(this.s.selector):this.$el.find(o(this.s.selector)),this.s.enableSlide||(this.s.controls=!1,this.s.mousewheel=!1,this.s.preload=0,this.s.counter=!1,this.s.enableDrag=!1,this.s.enableSwipe=!1),this.$slide="",this.$outer="",this.init(),this}var a={mode:"lg-slide",cssEasing:"ease",easing:"linear",speed:600,height:"100%",width:"100%",addClass:"",startClass:"lg-start-zoom",backdropDuration:150,hideBarsDelay:6e3,useLeft:!1,enableSlide:!0,closable:!0,loop:!0,escKey:!0,keyPress:!0,controls:!0,slideEndAnimatoin:!0,hideControlOnEnd:!1,mousewheel:!0,getCaptionFromTitleOrAlt:!0,appendSubHtmlTo:".lg-sub-html",subHtmlSelectorRelative:!1,preload:1,showAfterLoad:!0,selector:"",selectWithin:"",nextHtml:"",prevHtml:"",index:!1,iframeMaxWidth:"100%",download:!0,counter:!0,appendCounterTo:".lg-toolbar",swipeThreshold:function(){return o(l).width()/4},enableSwipe:!0,enableDrag:!0,dynamic:!1,dynamicEl:[],galleryId:1};s.prototype.init=function(){var e=this;e.s.preload>e.$items.length&&(e.s.preload=e.$items.length);var t=l.location.hash;0<t.indexOf("lg="+this.s.galleryId)&&(e.index=parseInt(t.split("&slide=")[1],10),o("body").addClass("lg-from-hash"),!o("body").hasClass("lg-on")&&setTimeout(function(){e.build(e.index),o("body").addClass("lg-on")})),e.s.dynamic?(e.$el.trigger("onBeforeOpen.lg"),e.index=e.s.index||0,!o("body").hasClass("lg-on")&&setTimeout(function(){e.build(e.index),o("body").addClass("lg-on")})):e.$items.on("click.lgcustom",function(l){try{l.preventDefault(),l.preventDefault()}catch(e){l.returnValue=!1}e.$el.trigger("onBeforeOpen.lg"),e.index=e.s.index||e.$items.index(this),o("body").hasClass("lg-on")||(e.build(e.index),o("body").addClass("lg-on"))})},s.prototype.build=function(e){var l=this;l.structure(),o.each(o.fn.lightGallery.modules,function(e){l.modules[e]=new o.fn.lightGallery.modules[e](l.el)}),l.slide(e,!1,!1),l.s.keyPress&&l.keyPress(),1<l.$items.length&&(l.arrow(),setTimeout(function(){l.enableDrag(),l.enableSwipe()},50),l.s.mousewheel&&l.mousewheel()),l.counter(),l.closeGallery(),l.$el.trigger("onAfterOpen.lg"),l.$outer.on("mousemove.lg click.lg touchstart.lg",function(){l.$outer.removeClass("lg-hide-items"),clearTimeout(l.hideBartimeout),l.hideBartimeout=setTimeout(function(){l.$outer.addClass("lg-hide-items")},l.s.hideBarsDelay)})},s.prototype.structure=function(){var e,t="",s="",a=0,r="",d=this;for(o("body").append("<div class=\"lg-backdrop\"></div>"),o(".lg-backdrop").css("transition-duration",this.s.backdropDuration+"ms"),a=0;a<this.$items.length;a++)t+="<div class=\"lg-item\"></div>";if(this.s.controls&&1<this.$items.length&&(s="<div class=\"lg-actions\"><div class=\"lg-prev lg-icon\">"+this.s.prevHtml+"</div><div class=\"lg-next lg-icon\">"+this.s.nextHtml+"</div></div>"),".lg-sub-html"===this.s.appendSubHtmlTo&&(r="<div class=\"lg-sub-html\"></div>"),e="<div class=\"lg-outer "+this.s.addClass+" "+this.s.startClass+"\"><div class=\"lg\" style=\"width:"+this.s.width+"; height:"+this.s.height+"\"><div class=\"lg-inner\">"+t+"</div><div class=\"lg-toolbar group\"><span class=\"lg-close lg-icon\"></span></div>"+s+r+"</div></div>",o("body").append(e),this.$outer=o(".lg-outer"),this.$slide=this.$outer.find(".lg-item"),this.s.useLeft?(this.$outer.addClass("lg-use-left"),this.s.mode="lg-slide"):this.$outer.addClass("lg-use-css3"),d.setTop(),o(l).on("resize.lg orientationchange.lg",function(){for(var e in setTimeout(function(){d.setTop()},100),d.imageData)d.setImageInfo(e)}),this.$slide.eq(this.index).addClass("lg-current"),this.doCss()?this.$outer.addClass("lg-css3"):(this.$outer.addClass("lg-css"),this.s.speed=0),this.$outer.addClass(this.s.mode),this.s.enableDrag&&1<this.$items.length&&this.$outer.addClass("lg-grab"),this.s.showAfterLoad&&this.$outer.addClass("lg-show-after-load"),this.doCss()){var n=this.$outer.find(".lg-inner");n.css("transition-timing-function",this.s.cssEasing),n.css("transition-duration",this.s.speed+"ms")}o(".lg-backdrop").addClass("in"),setTimeout(function(){d.$outer.addClass("lg-visible")},this.s.backdropDuration),this.s.download&&this.$outer.find(".lg-toolbar").append("<a id=\"lg-download\" target=\"_blank\" download class=\"lg-download lg-icon\"></a>"),this.prevScrollTop=o(l).scrollTop()},s.prototype.setTop=function(){if("100%"!==this.s.height){var e=o(l).height(),t=(e-parseInt(this.s.height,10))/2,s=this.$outer.find(".lg");e>=parseInt(this.s.height,10)?s.css("top",t+"px"):s.css("top","0px")}},s.prototype.doCss=function(){var e=function(){var e=["transition","MozTransition","WebkitTransition","OTransition","msTransition","KhtmlTransition"],o=t.documentElement,l=0;for(l=0;l<e.length;l++)if(e[l]in o.style)return!0};return!!e()},s.prototype.isVideo=function(e,o){var l;if(l=this.s.dynamic?this.s.dynamicEl[o].html:this.$items.eq(o).attr("data-html"),!e&&l)return{html5:!0};var t=e.match(/\/\/(?:www\.)?youtu(?:\.be|be\.com)\/(?:watch\?v=|embed\/)?([a-z0-9\-\_\%]+)/i),s=e.match(/\/\/(?:www\.)?vimeo.com\/([0-9a-z\-_]+)/i),a=e.match(/\/\/(?:www\.)?dai.ly\/([0-9a-z\-_]+)/i),i=e.match(/\/\/(?:www\.)?(?:vk\.com|vkontakte\.ru)\/(?:video_ext\.php\?)(.*)/i);return t?{youtube:t}:s?{vimeo:s}:a?{dailymotion:a}:i?{vk:i}:void 0},s.prototype.counter=function(){this.s.counter&&o(this.s.appendCounterTo).append("<div id=\"lg-counter\"><span id=\"lg-counter-current\">"+(parseInt(this.index,10)+1)+"</span> / <span id=\"lg-counter-all\">"+this.$items.length+"</span></div>")},s.prototype.addHtml=function(e){var l,t,s=null;if(this.s.dynamic?this.s.dynamicEl[e].subHtmlUrl?l=this.s.dynamicEl[e].subHtmlUrl:s=this.s.dynamicEl[e].subHtml:(t=this.$items.eq(e),t.attr("data-sub-html-url")?l=t.attr("data-sub-html-url"):(s=t.attr("data-sub-html"),this.s.getCaptionFromTitleOrAlt&&!s&&(s=t.attr("title")||t.find("img").first().attr("alt")))),!l)if("undefined"!=typeof s&&null!==s){var a=s.substring(0,1);("."===a||"#"===a)&&(this.s.subHtmlSelectorRelative&&!this.s.dynamic?s=t.find(s).html():s=o(s).html())}else s="";".lg-sub-html"===this.s.appendSubHtmlTo?l?this.$outer.find(this.s.appendSubHtmlTo).load(l):this.$outer.find(this.s.appendSubHtmlTo).html(s):l?this.$slide.eq(e).load(l):this.$slide.eq(e).append(s),"undefined"!=typeof s&&null!==s&&(""===s?this.$outer.find(this.s.appendSubHtmlTo).addClass("lg-empty-html"):this.$outer.find(this.s.appendSubHtmlTo).removeClass("lg-empty-html")),this.$el.trigger("onAfterAppendSubHtml.lg",[e])},s.prototype.preload=function(e){var o=1,l=1;for(o=1;o<=this.s.preload&&!(o>=this.$items.length-e);o++)this.loadContent(e+o,!1,0);for(l=1;l<=this.s.preload&&!(0>e-l);l++)this.loadContent(e-l,!1,0)},s.prototype.setImageInfo=function(e){var o=this;e="undefined"==typeof e?o.index:+e,o.imageData||(o.imageData={}),o.imageData[e]={};var l=o.imageData[e];o.$slide.addClass("lg-show"),l.$wrap=o.$slide.eq(e).find(".lg-img-wrap"),l.$img=l.$wrap.find(".lg-image"),l.$img[0]&&(l.width=l.$img.width(),l.height=l.$img.height(),o.s.dynamic?(l.naturalWidth=o.s.dynamicEl[e].width||l.$img[0].naturalWidth,l.naturalHeight=o.s.dynamicEl[e].height||l.$img[0].naturalHeight):(l.naturalWidth=o.$items.eq(e).attr("data-width")||l.$img[0].naturalWidth,l.naturalHeight=o.$items.eq(e).attr("data-height")||l.$img[0].naturalHeight),l.initialOffsetX=(l.$wrap.width()-l.width)/2,l.initialOffsetY=(l.$wrap.height()-l.height)/2,l.maxScale=l.naturalWidth/l.width||3,"undefined"==typeof l.$wrap.attr("data-x")&&o.setTranslate(l.$wrap,l.initialOffsetX,l.initialOffsetY)),o.viewportWidth=o.$outer.find(".lg").width(),o.viewportHeight=o.$outer.find(".lg").height(),o.$slide.removeClass("lg-show")},s.prototype.loadContent=function(e,t,s){var a,i,r,d,n,g,m=this,c=!1,u=function(e){for(var t,s=[],a=[],r=0;r<e.length;r++)t=e[r].split(" "),""===t[0]&&t.splice(0,1),a.push(t[0]),s.push(t[1]);for(var d=o(l).width(),n=0;n<s.length;n++)if(parseInt(s[n],10)>d){i=a[n];break}};if(m.s.dynamic){if(m.s.dynamicEl[e].poster&&(c=!0,r=m.s.dynamicEl[e].poster),g=m.s.dynamicEl[e].html,i=m.s.dynamicEl[e].src,m.s.dynamicEl[e].responsive){var p=m.s.dynamicEl[e].responsive.split(",");u(p)}d=m.s.dynamicEl[e].srcset,n=m.s.dynamicEl[e].sizes}else{if(m.$items.eq(e).attr("data-poster")&&(c=!0,r=m.$items.eq(e).attr("data-poster")),g=m.$items.eq(e).attr("data-html"),i=m.$items.eq(e).attr("href")||m.$items.eq(e).attr("data-src"),m.$items.eq(e).attr("data-responsive")){var h=m.$items.eq(e).attr("data-responsive").split(",");u(h)}d=m.$items.eq(e).attr("data-srcset"),n=m.$items.eq(e).attr("data-sizes")}var $=!1;m.s.dynamic?m.s.dynamicEl[e].iframe&&($=!0):"true"===m.$items.eq(e).attr("data-iframe")&&($=!0);var f=m.isVideo(i,e);if(!m.$slide.eq(e).hasClass("lg-loaded")){if($)m.$slide.eq(e).prepend("<div class=\"lg-video-cont\" style=\"max-width:"+m.s.iframeMaxWidth+"\"><div class=\"lg-video\"><iframe class=\"lg-object\" frameborder=\"0\" src=\""+i+"\"  allowfullscreen=\"true\"></iframe></div></div>");else if(c){var y="";y=f&&f.youtube?"lg-has-youtube":f&&f.vimeo?"lg-has-vimeo":"lg-has-html5",m.$slide.eq(e).prepend("<div class=\"lg-video-cont "+y+" \"><div class=\"lg-video\"><span class=\"lg-video-play\"></span><img class=\"lg-object lg-has-poster\" src=\""+r+"\" /></div></div>")}else f?(m.$slide.eq(e).prepend("<div class=\"lg-video-cont \"><div class=\"lg-video\"></div></div>"),m.$el.trigger("hasVideo.lg",[e,i,g])):m.$slide.eq(e).prepend("<div class=\"lg-img-wrap\"><img class=\"lg-object lg-image\" src=\""+i+"\" /></div>");if(m.$el.trigger("onAferAppendSlide.lg",[e]),a=m.$slide.eq(e).find(".lg-object"),n&&a.attr("sizes",n),d){a.attr("srcset",d);try{picturefill({elements:[a[0]]})}catch(o){console.error("Make sure you have included Picturefill version 2")}}".lg-sub-html"!==this.s.appendSubHtmlTo&&m.addHtml(e),m.$slide.eq(e).addClass("lg-loaded")}m.$slide.eq(e).find(".lg-object").on("load.lg error.lg",function(){m.setImageInfo(e);var l=0;s&&!o("body").hasClass("lg-from-hash")&&(l=s),setTimeout(function(){m.$slide.eq(e).addClass("lg-complete"),m.$el.trigger("onSlideItemLoad.lg",[e,s||0])},l)}),f&&f.html5&&!c&&m.$slide.eq(e).addClass("lg-complete"),!0===t&&(m.$slide.eq(e).hasClass("lg-complete")?m.preload(e):m.$slide.eq(e).find(".lg-object").on("load.lg error.lg",function(){m.preload(e)}))},s.prototype.slide=function(e,l,t){var s=this.$outer.find(".lg-current").index(),a=this;if(!(a.lGalleryOn&&s===e)){var i=this.$slide.length,r=a.lGalleryOn?this.s.speed:0,d=!1,n=!1;if(!a.lgBusy){if(this.s.download){var g;g=a.s.dynamic?!1!==a.s.dynamicEl[e].downloadUrl&&(a.s.dynamicEl[e].downloadUrl||a.s.dynamicEl[e].src):"false"!==a.$items.eq(e).attr("data-download-url")&&(a.$items.eq(e).attr("data-download-url")||a.$items.eq(e).attr("href")||a.$items.eq(e).attr("data-src")),g?(o("#lg-download").attr("href",g),a.$outer.removeClass("lg-hide-download")):a.$outer.addClass("lg-hide-download")}this.$el.trigger("onBeforeSlide.lg",[s,e,l,t]),a.lgBusy=!0,clearTimeout(a.hideBartimeout),".lg-sub-html"===this.s.appendSubHtmlTo&&a.addHtml(e),this.arrowDisable(e),e<s?(n=!0,a.s.loop&&2<i&&0==e&&s===i-1&&!t&&(n=!1,d=!0)):e>s&&(d=!0,a.s.loop&&2<i&&e==i-1&&0===s&&!t&&(n=!0,d=!1)),a.$outer.addClass("lg-no-trans"),this.$slide.removeClass("lg-prev-slide lg-next-slide lg-current"),n?(this.$slide.eq(e).addClass("lg-prev-slide"),this.$slide.eq(s).addClass("lg-next-slide")):d&&(this.$slide.eq(e).addClass("lg-next-slide"),this.$slide.eq(s).addClass("lg-prev-slide")),a.$outer.removeClass("lg-no-trans"),setTimeout(function(){a.$slide.eq(e).addClass("lg-current"),a.$slide.removeAttr("style"),a.lGalleryOn?setTimeout(function(){a.loadContent(e,!0,0),a.lgBusy=!1,a.$el.trigger("onAfterSlide.lg",[s,e,l,t])},a.s.speed):(a.loadContent(e,!0,a.s.backdropDuration),a.lgBusy=!1,a.$el.trigger("onAfterSlide.lg",[s,e,l,t]))},l?0:50),a.lGalleryOn=!0,this.s.counter&&o("#lg-counter-current").text(e+1)}}},s.prototype.goToNextSlide=function(e){var o=this;o.lgBusy||(o.index+1<o.$slide.length?(o.index++,o.$el.trigger("onBeforeNextSlide.lg",[o.index]),o.slide(o.index,e,!1)):o.s.loop?(o.index=0,o.$el.trigger("onBeforeNextSlide.lg",[o.index]),o.slide(o.index,e,!1)):o.s.slideEndAnimatoin&&(o.$outer.addClass("lg-right-end"),setTimeout(function(){o.$outer.removeClass("lg-right-end")},400)))},s.prototype.goToPrevSlide=function(e){var o=this;o.lgBusy||(0<o.index?(o.index--,o.$el.trigger("onBeforePrevSlide.lg",[o.index,e]),o.slide(o.index,e,!1)):o.s.loop?(o.index=o.$items.length-1,o.$el.trigger("onBeforePrevSlide.lg",[o.index,e]),o.slide(o.index,e,!1)):o.s.slideEndAnimatoin&&(o.$outer.addClass("lg-left-end"),setTimeout(function(){o.$outer.removeClass("lg-left-end")},400)))},s.prototype.keyPress=function(){var t=this;1<this.$items.length&&o(l).on("keyup.lg",function(o){1<t.$items.length&&(37===o.keyCode&&(o.preventDefault(),t.goToPrevSlide()),39===o.keyCode&&(o.preventDefault(),t.goToNextSlide()))}),o(l).on("keydown.lg",function(o){!0===t.s.escKey&&27===o.keyCode&&(o.preventDefault(),t.$outer.hasClass("lg-thumb-open")?t.$outer.removeClass("lg-thumb-open"):t.destroy())})},s.prototype.arrow=function(){var e=this;this.$outer.find(".lg-prev").on("click.lg",function(){e.goToPrevSlide()}),this.$outer.find(".lg-next").on("click.lg",function(){e.goToNextSlide()})},s.prototype.arrowDisable=function(e){!this.s.loop&&this.s.hideControlOnEnd&&(e+1<this.$slide.length?this.$outer.find(".lg-next").removeAttr("disabled").removeClass("disabled"):this.$outer.find(".lg-next").attr("disabled","disabled").addClass("disabled"),0<e?this.$outer.find(".lg-prev").removeAttr("disabled").removeClass("disabled"):this.$outer.find(".lg-prev").attr("disabled","disabled").addClass("disabled"))},s.prototype.setTranslate=function(e,o,l){this.s.useLeft?e.css("left",o):e.css({transform:"translate3d("+o+"px, "+l+"px, 0px)"})},s.prototype.touchMove=function(e,l){var t=l-e;if(t){var s=this.s.margin||20,a=this.imageData[this.index];30<Math.abs(t)&&(this.isDraging=!0),this.$outer.addClass("lg-dragging"),this.setTranslate(this.$slide.eq(this.index),t,0),this.setTranslate(o(".lg-prev-slide"),-this.viewportWidth+t-s,0),this.setTranslate(o(".lg-next-slide"),this.viewportWidth+t+s,0)}},s.prototype.touchEnd=function(e){var o=this,l="function"==typeof o.s.swipeThreshold?o.s.swipeThreshold():o.s.swipeThreshold;"lg-slide"!==o.s.mode&&o.$outer.addClass("lg-slide"),this.$slide.not(".lg-current, .lg-prev-slide, .lg-next-slide").css("opacity","0"),setTimeout(function(){o.isDraging=!1,o.$outer.removeClass("lg-dragging"),0>e&&Math.abs(e)>l?o.goToNextSlide(!0):0<e&&Math.abs(e)>l?o.goToPrevSlide(!0):5>Math.abs(e)&&o.$el.trigger("onSlideClick.lg"),o.$slide.removeAttr("style")},50),setTimeout(function(){o.$outer.hasClass("lg-dragging")||"lg-slide"===o.s.mode||o.$outer.removeClass("lg-slide")},o.s.speed+100)},s.prototype.enableSwipe=function(){function e(o){n=o.originalEvent.touches.length,s.lgBusy||1!=n||(r=!0,!s.$outer.hasClass("lg-zoomed")&&!s.lgBusy&&(s.manageSwipeClass(),a=o.originalEvent.touches[0].pageX),(30>a||a>s.viewportWidth-30)&&(g=!0),s.$outer.removeClass("lg-hide-items"))}function o(o){var e=s.modules.zoom&&s.modules.zoom.isInZoom;!r||s.lgBusy||s.$outer.hasClass("lg-zoomed")||e||(o.preventDefault(),i=o.originalEvent.touches[0].pageX,s.touchMove(a,i),d=!0,g&&(clearTimeout(t),t=setTimeout(function(){d=!1,r=!1,g=!1,s.touchEnd(i-a)},200)))}function l(o){n=o.originalEvent.touches.length,g=!1,0===n&&(r=!1,!s.$outer.hasClass("lg-zoomed")&&(d?(d=!1,s.touchEnd(i-a)):s.$el.trigger("onSlideClick.lg")))}var t,s=this,a=0,i=0,r=!1,d=!1,n=0,g=!1;s.s.enableSwipe&&s.isTouch&&s.doCss()&&(s.$outer.off("touchstart.lg").on("touchstart.lg",e),s.$outer.off("touchmove.lg").on("touchmove.lg",o),s.$outer.off("touchend.lg").on("touchend.lg",l))},s.prototype.enableDrag=function(){var t=this,s=0,a=0,i=!1,r=0;t.s.enableDrag&&!t.isTouch&&t.doCss()&&(t.$slide.on("mousedown.lg",function(l){!t.$outer.hasClass("lg-zoomed")&&(o(l.target).hasClass("lg-object")||o(l.target).hasClass("lg-video-play"))&&(l.preventDefault(),!t.lgBusy&&(t.manageSwipeClass(),s=l.pageX,t.isDraging=!0,t.$outer.scrollLeft+=1,t.$outer.scrollLeft-=1,t.$outer.removeClass("lg-grab").addClass("lg-grabbing"),t.$el.trigger("onDragstart.lg")))}),o(l).on("mousemove.lg",function(d){flexbe_cli.is_admin&&(r=o(l).width()/6),t.isDraging&&(i=!0,a=d.pageX,t.touchMove(s,a),t.$el.trigger("onDragmove.lg"),(d.pageX<r||d.pageX>o(l).width()-r)&&o(l).trigger("mouseup.lg"))}),o(l).on("mouseup.lg",function(l){i?(i=!1,t.touchEnd(a-s),t.$el.trigger("onDragend.lg")):(o(l.target).hasClass("lg-object")||o(l.target).hasClass("lg-video-play"))&&t.$el.trigger("onSlideClick.lg"),t.isDraging&&(t.isDraging=!1,t.$outer.removeClass("lg-grabbing").addClass("lg-grab"))}))},s.prototype.manageSwipeClass=function(){var e=this.index+1,o=this.index-1,l=this.$slide.length;this.s.loop&&(0===this.index?o=l-1:this.index===l-1&&(e=0)),this.$slide.removeClass("lg-next-slide lg-prev-slide"),-1<o&&this.$slide.eq(o).addClass("lg-prev-slide"),this.$slide.eq(e).addClass("lg-next-slide")},s.prototype.mousewheel=function(){var o=this;o.$outer.on("mousewheel.lg",function(l){l.deltaY&&(0<l.deltaY?o.goToPrevSlide():o.goToNextSlide(),l.preventDefault())})},s.prototype.closeGallery=function(){var l=this,t=!1;this.$outer.find(".lg-close").on("click.lg",function(){l.destroy()}),l.s.closable&&(l.$outer.on("mousedown.lg",function(l){t=!!(o(l.target).is(".lg-outer")||o(l.target).is(".lg-item ")||o(l.target).is(".lg-img-wrap"))}),l.$outer.on("mouseup.lg",function(s){(o(s.target).is(".lg-outer")||o(s.target).is(".lg-item ")||o(s.target).is(".lg-img-wrap")&&t)&&!l.$outer.hasClass("lg-dragging")&&l.destroy()}))},s.prototype.destroy=function(e){var t=this;e||t.$el.trigger("onBeforeClose.lg"),o(l).scrollTop(t.prevScrollTop),e&&(!t.s.dynamic&&this.$items.off("click.lg click.lgcustom"),o.removeData(t.el,"lightGallery")),this.$el.off(".lg.tm"),o.each(o.fn.lightGallery.modules,function(e){t.modules[e]&&t.modules[e].destroy()}),this.lGalleryOn=!1,clearTimeout(t.hideBartimeout),this.hideBartimeout=!1,o(l).off(".lg"),o("body").removeClass("lg-on lg-from-hash"),t.$outer&&t.$outer.removeClass("lg-visible"),o(".lg-backdrop").removeClass("in"),setTimeout(function(){t.$outer&&t.$outer.remove(),o(".lg-backdrop").remove(),e||t.$el.trigger("onCloseAfter.lg")},t.s.backdropDuration+50)},o.fn.lightGallery=function(e){return this.each(function(){if(!o.data(this,"lightGallery"))o.data(this,"lightGallery",new s(this,e));else try{o(this).data("lightGallery").init()}catch(e){console.error("lightGallery has not initiated properly")}})},o.fn.lightGallery.modules={}})(jQuery,window,document),function(o,l){"use strict";var t={scale:1,zoom:!0,actualSize:!0,zoomIcons:!0,enableZoomAfter:300},s=function(e){return this.core=o(e).data("lightGallery"),this.core.s=o.extend({},t,this.core.s),this.core.s.zoom&&this.core.doCss()&&(this.init(),this.zoomabletimeout=!1,this.pageX=o(l).width()/2,this.pageY=o(l).height()/2+o(l).scrollTop()),this.core.imageData||(this.core.imageData={}),this};s.prototype.init=function(){var e,t=this;t.core.s.zoomIcons&&(e="<span id=\"lg-zoom-in\" class=\"lg-icon\"></span><span id=\"lg-zoom-out\" class=\"lg-icon\"></span>"),t.core.s.actualSize&&(e+="<span id=\"lg-actual-size\" class=\"lg-icon\"></span>"),this.core.$outer.find(".lg-toolbar").append(e),t.core.$el.off("onBeforeSlide.lg.tm.zoom").on("onBeforeSlide.lg.tm.zoom",function(o,e){t.fitImage(e,!0)}),t.core.$el.on("onSlideItemLoad.lg.tm.zoom",function(e,l,s){t.savePosition(l);var a=t.core.s.enableZoomAfter+s;o("body").hasClass("lg-from-hash")&&s?a=0:o("body").removeClass("lg-from-hash"),t.zoomabletimeout=setTimeout(function(){t.core.$slide.eq(l).addClass("lg-zoomable")},a+30)}),t.core.$slide.on("dblclick",".lg-image",function(o){t.actualSize(o)});var s=0,a=!1;t.core.$slide.on("touchstart",".lg-image",function(o){o.preventDefault(),s=o.originalEvent.touches&&o.originalEvent.touches.length,1==s&&(a?(clearTimeout(a),a=null,t.actualSize(o)):a=setTimeout(function(){a=null},300))});var i;o(l).off("resize.lg_zoom orientationchange.lg_zoom").on("resize.lg_zoom orientationchange.lg_zoom",function(){clearTimeout(i),i=setTimeout(function(){for(var e in t.core.imageData)t.fitImage(e,!0)},100)}),t.core.s.zoomIcons&&(o("#lg-zoom-out").off("click.lg").on("click.lg",function(){var e=t.core.imageData[t.core.index],o=+e.$wrap.attr("data-scale")||1;t.core.$outer.find(".lg-current .lg-image").length&&(o-=1,t.zoom(o),t.fitImage())}),o("#lg-zoom-in").off("click.lg").on("click.lg",function(){var e=t.core.imageData[t.core.index],o=+e.$wrap.attr("data-scale")||1;t.core.$outer.find(".lg-current .lg-image").length&&(o+=1,t.zoom(o),t.fitImage())})),t.core.s.actualSize&&o("#lg-actual-size").off("click.lg").on("click.lg",function(o){t.actualSize(o,!0)}),t.core.isTouch?t.zoomPitch():(t.mouseDrag(),t.scrollZoom())},s.prototype.zoomPitch=function(){function e(o){if(!g.core.isDraging){var e=t(o);i=g.core.imageData[g.core.index],u=+i.$wrap.attr("data-scale")||i.scale||1,p||(p=!0,r=e[0],i=g.core.imageData[g.core.index]),!h&&2<=e.length&&(h=!0,g.savePosition(),r=s(e)),g.isZoomed&&o.preventDefault(),m=a(e)}}function o(o){if(!g.core.isDraging){o.preventDefault();var e,l=t(o),i=0,p=0,h=u;if(d=l[0],g.core.$outer.addClass("lg-zoom-dragging lg-no-trans"),n=s(l),c=a(l),2==l.length){var $=c-m;e=4*Math.floor(100*$/g.core.viewportHeight),h=u*parseFloat((100+e)/100)}g.isZoomed&&(i=n.x-r.x,p=n.y-r.y),(u!=h||g.isZoomed&&(i||p))&&g.zoom(h,n.x,n.y,i,p)}}function l(o){if(!g.core.isDraging){var e=t(o);u=+i.$wrap.attr("data-scale"),1==e.length&&(r=e[0],d=e[0],g.savePosition()),1>=e.length&&(h=!1),0===e.length&&(p=!1,g.fitImage())}}function t(o){if(!o.originalEvent.touches)return!1;var e=[];for(var l in o.originalEvent.touches){var t=o.originalEvent.touches[l];t.clientX&&e.push({x:t.clientX,y:t.clientY})}return e}function s(e){var o=0,l=0;return e.forEach(function(e){o+=e.x,l+=e.y}),{x:o/e.length,y:l/e.length}}function a(e){return 1<e.length?Math.sqrt(Math.pow(e[1].x-e[0].x,2)+Math.pow(e[1].y-e[0].y,2)):0}var i,r,d,n,g=this,m=0,c=0,u=1,p=!1,h=!1;g.core.$slide.off("touchstart.lg_zoom_pitch").on("touchstart.lg_zoom_pitch",e),g.core.$slide.off("touchmove.lg_zoom_pitch").on("touchmove.lg_zoom_pitch",o),g.core.$slide.off("touchend.lg_zoom_pitch").on("touchend.lg_zoom_pitch",l)},s.prototype.scrollZoom=function(){var t,s=this;s.core.$slide.off("mousewheel.lg_zoom").on("mousewheel.lg_zoom",function(a){var e=a.originalEvent,i=s.core.imageData[s.core.index];if(i&&!s.core.isDraging){var r=+i.$wrap.attr("data-scale")||1,d=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail))/10*(r+1),n=r+d,g=e.pageX,m=e.pageY-o(l).scrollTop();n>i.maxScale||(s.zoom(n,g,m),s.savePosition(),clearTimeout(t),t=setTimeout(function(){s.fitImage()},150),a.preventDefault())}})},s.prototype.mouseDrag=function(){var t=this,s={},a={},i=!1;t.core.$slide.on("mousedown.lg_zoom",function(l){t.core.imageData[t.core.index];t.isZoomed&&o(l.target).hasClass("lg-object")&&(l.preventDefault(),s={x:l.pageX,y:l.pageY},i=!0,t.core.$outer.scrollLeft+=1,t.core.$outer.scrollLeft-=1,t.core.$outer.removeClass("lg-grab").addClass("lg-grabbing"))}),o(l).on("mousemove.lg_zoom",function(o){if(i){var e,l,r=t.core.imageData[t.core.index];a={x:o.pageX,y:o.pageY},t.core.$outer.addClass("lg-zoom-dragging"),e=a.x-s.x,l=a.y-s.y,t.zoom(r.scale,0,0,e,l)}}),o(l).on("mouseup.lg_zoom",function(){i&&(i=!1,t.fitImage()),(t.core.s.enableDrag||t.isZoomed)&&t.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")})},s.prototype.checkPosition=function(e,o,l,t,s){var a,i,r=this,d=0,n=0;"undefined"==typeof s&&(s=r.core.index);var g=r.core.imageData[s];if(g){t=t||+g.$wrap.attr("data-scale")||1,t>g.maxScale&&(t=g.maxScale),e?1>t&&(t=1):1>t&&(t=1-.2*(1-t),.5>t&&(t=.5));var m=g.width*t,c=g.height*t,u=m>r.core.viewportWidth,p=c>r.core.viewportHeight;if(u?(d=0,a=r.core.viewportWidth-m):(d=(r.core.viewportWidth-m)/2,a=d),p?(n=0,i=r.core.viewportHeight-c):(n=(r.core.viewportHeight-c)/2,i=n),!e){var h,$,f=.05*t;h=0<=o?(o-d)*f:(o-a)*f,$=0<=l?(l-n)*f:(l-i)*f,d+=h,a+=h,n+=$,i+=$}return o>d?o=d:o<a&&(o=a),l>n?l=n:l<i&&(l=i),{x:o,y:l,scale:t}}},s.prototype.actualSize=function(e,t){var s=this,a=s.core.index,i=s.core.imageData[a];if(i){var r,d,n=+i.$wrap.attr("data-scale")||1;n=s.isZoomed?1:i.maxScale,t||(r=e.pageX||e.originalEvent.targetTouches[0].pageX,d=(e.pageY||e.originalEvent.targetTouches[0].pageY)-o(l).scrollTop()),s.zoom(n,r,d),s.savePosition(),setTimeout(function(){s.core.s.enableDrag||s.isZoomed?s.core.$outer.removeClass("lg-grabbing").addClass("lg-grab"):s.core.$outer.removeClass("lg-grab lg-grabbing")},10)}},s.prototype.fitImage=function(e,o){var l=this;if("undefined"==typeof e&&(e=this.core.index),!!l.core.imageData){var t=l.core.imageData[e];if(t){l.core.$outer.removeClass("lg-zoom-dragging lg-no-trans");var s=t.initialOffsetX,a=t.initialOffsetY,i=1;o||(s=+t.$wrap.attr("data-x")||s,a=+t.$wrap.attr("data-y")||a,i=+t.$wrap.attr("data-scale")||i);var r=l.checkPosition(!0,s,a,i,e);l.setPosition(r.x,r.y,r.scale,e),l.savePosition(),1>=r.scale&&(l.isInZoom=!1)}}},s.prototype.zoom=function(e,o,l,t,s){var a=this,i=this.core.imageData[this.core.index];if(i&&e){var r,d;e>i.maxScale&&(e=i.maxScale),o&&l||(o=a.core.viewportWidth/2,l=a.core.viewportHeight/2);var n=e/i.scale;r=i.offsetX+(i.offsetX-o)*(n-1),d=i.offsetY+(i.offsetY-l)*(n-1);"undefined"!=typeof t&&"undefined"!=typeof s&&(r+=t*n,d+=s*n);var g=a.checkPosition(!1,r,d,e);a.setPosition(g.x,g.y,g.scale),a.isInZoom=!0,a.isZoomed=1<g.scale,a.core.$outer.toggleClass("lg-zoomed",1<e),a.core.$outer.toggleClass("lg-zoom-max",e>=i.maxScale),a.core.$slide.removeAttr("style")}},s.prototype.savePosition=function(e){var o=this;e="undefined"==typeof e?this.core.index:e;var l=o.core.imageData[e];l&&(l.scale=+l.$wrap.attr("data-scale")||1,l.offsetX=+l.$wrap.attr("data-x")||l.initialOffsetX,l.offsetY=+l.$wrap.attr("data-y")||l.initialOffsetY)},s.prototype.resetZoom=function(e){var o=this;e="undefined"==typeof e?this.core.index:e;var l=o.core.imageData[e];l&&(this.core.$outer.removeClass("lg-zoomed"),this.isZoomed=!1,this.isInZoom=!1,this.zoom(1,0,0,e),this.savePosition(e))},s.prototype.setPosition=function(e,o,l,t){var s=this;"undefined"==typeof t&&(t=s.core.index);var a=s.core.imageData[t];l=l||a.$wrap.attr("data-scale")||1,e=Math.floor(e)||0,o=Math.floor(o)||0,a.$wrap.css({transform:"translate3d("+e+"px, "+o+"px, 0) scale("+l+")"}).attr("data-x",e).attr("data-y",o).attr("data-scale",l)},s.prototype.destroy=function(){var e=this;e.core.$el.off(".lg_zoom"),o(l).off(".lg_zoom"),e.core.$slide.off(".lg_zoom"),e.core.$el.off(".lg.tm.zoom"),e.resetZoom(),clearTimeout(e.zoomabletimeout),e.zoomabletimeout=!1},setTimeout(function(){o.fn.lightGallery.modules.zoom=s},300)}(jQuery,window,document);
